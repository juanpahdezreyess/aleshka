<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>Fugas de Agua ‚Äì App</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* VARIABLES */
:root {
  --bg: #f5f6f7;
  --card: #ffffffcc;
  --border: rgba(0,0,0,0.06);
  --text: #0f172a;
  --muted: #6b7280;
  --primary: #2563eb;
  --primary-soft: #e0eaff;
  --accent: #22c55e;
  --danger: #ef4444;
  --yellow: #facc15;
  --shadow: 0 8px 24px rgba(0,0,0,0.06);
  --radius: 18px;
}

/* RESET */
* { margin: 0; padding: 0; box-sizing: border-box; font-family: "Inter", sans-serif; }

html, body { height: 100%; background: var(--bg); }

/* APP ROOT */
.app-root {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: var(--bg);
  padding-bottom: calc(70px + env(safe-area-inset-bottom));
  overflow-x: hidden;
}

/* HEADER */
.app-header {
  padding: 14px 20px 10px;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(0,0,0,0.06);
  position: sticky;
  top: 0;
  z-index: 15;
}

.app-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
}
.app-subtitle {
  font-size: 12px;
  color: var(--muted);
}

/* STATUS LABEL */
.status-pill {
  margin-top: 8px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 12px;
  border-radius: 999px;
  background: #e6fef3;
  color: #0d7c47;
  font-size: 12px;
}
.status-dot {
  width: 8px; height: 8px;
  border-radius: 999px;
  background: var(--accent);
}

/* CONTENT */
.app-content {
  flex: 1;
  padding: 18px 18px 90px;
  scroll-behavior: smooth;
}

/* SECTION TITLE */
.section-title {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 10px;
  color: var(--text);
}

/* GRID RESUMEN */
.summary-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-bottom: 20px;
}

.summary-card {
  background: var(--card);
  padding: 14px;
  border-radius: var(--radius);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  transition: 0.2s;
}
.summary-card:hover {
  transform: translateY(-2px);
}

.summary-label {
  font-size: 12px;
  color: var(--muted);
}
.summary-value {
  margin-top: 2px;
  font-size: 18px;
  font-weight: 700;
}
.summary-chip,
.summary-chip-red {
  margin-top: 6px;
  padding: 3px 10px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
}
.summary-chip { background: #dcfce7; color: #166534; }
.summary-chip-red { background: #fee2e2; color: #991b1b; }

/* CHART */
.chart-card {
  background: var(--card);
  padding: 14px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  margin-bottom: 20px;
}
.chart-title {
  font-size: 14px;
  font-weight: 600;
}
.chart-subtitle {
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 8px;
}

.chart-container {
  width: 100%;
  height: 180px;
}

/* LIST CARDS */
.list-card {
  background: var(--card);
  padding: 14px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  margin-bottom: 16px;
}

.list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.list-item {
  background: white;
  border-radius: 14px;
  padding: 10px 12px;
  border: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: 0.15s;
}
.list-item:hover { transform: scale(1.015); }

.list-title {
  font-size: 13px;
  font-weight: 600;
}
.list-meta {
  font-size: 11px;
  color: var(--muted);
}

.badge {
  padding: 3px 10px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  border: 1px solid var(--border);
  white-space: nowrap;
}
.badge-green { background: #dcfce7; color: #166534; }
.badge-yellow { background: #fef9c3; color: #855d0e; }
.badge-red { background: #fee2e2; color: #991b1b; }

/* IA */
.ai-risk { font-size: 16px; font-weight: 700; }
.ai-risk-high { color: #b91c1c; }
.ai-risk-mid { color: #ca8a04; }
.ai-desc { font-size: 12px; color: var(--muted); margin-top: 4px; }

/* TABS IOS */
.tab-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: calc(58px + env(safe-area-inset-bottom));
  padding-bottom: env(safe-area-inset-bottom);
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(18px);
  border-top: 1px solid rgba(0,0,0,0.06);
  display: flex;
  justify-content: space-around;
  align-items: center;
  z-index: 20;
}

.tab-btn {
  flex: 1;
  text-align: center;
  border: none;
  background: none;
  font-size: 11px;
  color: var(--muted);
  padding: 4px 0;
}
.tab-btn span.icon { font-size: 18px; }

.tab-btn-active {
  color: var(--primary);
  font-weight: 600;
}

.tab-pill {
  padding: 3px 8px;
  border-radius: 999px;
}

/* PANELS */
.tab-panel { display: none; animation: fade 0.2s ease-out; }
.tab-panel.active { display: block; }

@keyframes fade {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}

</style>
</head>

<body>

<div class="app-root">

  <!-- HEADER -->
  <header class="app-header">
    <div>
      <div class="app-title">Fugas de Agua</div>
      <div class="app-subtitle" id="headerDate">Hoy</div>
    </div>

    <div class="status-pill">
      <span class="status-dot"></span>
      Activo
    </div>
  </header>

  <!-- CONTENT -->
  <main class="app-content">

    <!-- HOME -->
    <section id="tab-home" class="tab-panel active">

      <h3 class="section-title">Resumen general</h3>

      <div class="summary-grid">

        <div class="summary-card">
          <div class="summary-label">Consumo hoy</div>
          <div class="summary-value" id="consumoHoy">‚Äì</div>
          <div class="summary-chip">Normal</div>
        </div>

        <div class="summary-card">
          <div class="summary-label">Consumo mensual</div>
          <div class="summary-value" id="consumoMes">‚Äì</div>
          <div class="summary-chip">Comparativa</div>
        </div>

        <div class="summary-card">
          <div class="summary-label">Sensores activos</div>
          <div class="summary-value" id="summarySensors">‚Äì</div>
          <div class="summary-chip">Online</div>
        </div>

        <div class="summary-card">
          <div class="summary-label">Fugas activas</div>
          <div class="summary-value" id="summaryLeaks">‚Äì</div>
          <div class="summary-chip-red">Revisi√≥n</div>
        </div>

      </div>

      <!-- GRAFICA -->
      <div class="chart-card">
        <div class="chart-title">Consumo √∫ltimos 7 d√≠as</div>
        <div class="chart-subtitle">Flujo monitoreado en tuber√≠as principales</div>
        <div class="chart-container"><canvas id="consumoChart"></canvas></div>
      </div>

    </section>

    <!-- SENSORES -->
    <section id="tab-sensors" class="tab-panel">
      <h3 class="section-title">Sensores y tuber√≠as</h3>

      <div class="list-card">
        <div class="section-title">Presi√≥n por sensor</div>
        <div class="list" id="listaSensores"></div>
      </div>

      <div class="list-card">
        <div class="section-title">Errores recientes</div>
        <div class="list" id="listaErrores"></div>
      </div>
    </section>

    <!-- ALERTAS -->
    <section id="tab-alerts" class="tab-panel">
      <h3 class="section-title">Alertas y fugas</h3>

      <div class="list-card">
        <div class="section-title">Alertas de hoy</div>
        <div class="list" id="listaAlertas"></div>
      </div>

      <div class="list-card">
        <div class="section-title">Historial de fugas</div>
        <div class="list" id="listaFugas"></div>
      </div>
    </section>

    <!-- IA -->
    <section id="tab-ai" class="tab-panel">
      <h3 class="section-title">Predicciones IA</h3>

      <div class="list-card">
        <p class="ai-desc">
          La IA analiza presi√≥n, consumo, historial de fugas y errores para estimar probabilidades de fuga.
        </p>
      </div>

      <div class="list-card">
        <div class="section-title">Predicciones actuales</div>
        <div class="list" id="listaPredicciones"></div>
      </div>
    </section>

  </main>

  <!-- TABS IOS -->
  <nav class="tab-bar">
    <button class="tab-btn tab-btn-active" data-tab="home">
      <span class="icon">üè†</span> Inicio
    </button>
    <button class="tab-btn" data-tab="sensors">
      <span class="icon">üßä</span> Sensores
    </button>
    <button class="tab-btn" data-tab="alerts">
      <span class="icon">üö®</span> Alertas
    </button>
    <button class="tab-btn" data-tab="ai">
      <span class="icon">ü§ñ</span> IA
    </button>
  </nav>

</div>

<script>
/* DATOS SIMULADOS */
const sensores = [
  { id: "S-001", ubicacion: "Edificio A ‚Äì Principal", presion: 74, estado: "OK" },
  { id: "S-002", ubicacion: "Edificio A ‚Äì Piso 2", presion: 69, estado: "OK" },
  { id: "S-003", ubicacion: "Edificio B ‚Äì Subsuelo", presion: 48, estado: "WARN" },
  { id: "S-004", ubicacion: "Estacionamiento", presion: 31, estado: "CRIT" },
];

const errores = [
  { fecha: "28/11/25 10:14", sensor: "S-004", tipo: "Timeout" },
  { fecha: "28/11/25 09:51", sensor: "S-003", tipo: "Rango fuera" },
];

const alertas = [
  { hora: "18:42", titulo: "Ca√≠da de presi√≥n", detalle: "20% en 5 min ‚Äî S-004", nivel: "Cr√≠tica" },
  { hora: "03:15", titulo: "Consumo nocturno", detalle: "35% mayor ‚Äî Zona A", nivel: "Media" },
];

const fugas = [
  { fecha: "28/11/25", sensor: "S-004", nivel: "Alta", estado: "En reparaci√≥n" },
  { fecha: "26/11/25", sensor: "S-003", nivel: "Media", estado: "Resuelta" },
];

const predicciones = [
  { sensor: "S-004 ‚Äì Estacionamiento", prob: 0.82, plazo: "24 h", motivo: "Historial + presi√≥n" },
  { sensor: "S-003 ‚Äì Subsuelo", prob: 0.64, plazo: "3 d√≠as", motivo: "Variaciones de presi√≥n" },
];

const consumoSemanal = { dias: ["Lun","Mar","Mi√©","Jue","Vie","S√°b","Dom"], valores: [13.2,12.7,14.1,13.8,15.5,11.9,10.8] };

document.getElementById("consumoHoy").textContent = "10.8 m¬≥";
document.getElementById("consumoMes").textContent = "320.4 m¬≥";
document.getElementById("summarySensors").textContent = sensores.length;
document.getElementById("summaryLeaks").textContent = fugas.filter(f=>f.estado!=="Resuelta").length;

/* FUNCIONES DE PINTADO */
function addItem(parent, title, meta, badge, badgeClass) {
  const div = document.createElement("div");
  div.className = "list-item";
  div.innerHTML = `
    <div>
      <div class="list-title">${title}</div>
      <div class="list-meta">${meta}</div>
    </div>
    <span class="badge ${badgeClass}">${badge}</span>
  `;
  parent.appendChild(div);
}

/* SENSORES */
sensores.forEach(s => {
  let badge="Normal", bc="badge-green";
  if(s.estado==="WARN") { badge="Atenci√≥n"; bc="badge-yellow"; }
  if(s.estado==="CRIT") { badge="Cr√≠tico"; bc="badge-red"; }
  addItem(listaSensores, `${s.id} ¬∑ ${s.presion} psi`, s.ubicacion, badge, bc);
});

/* ERRORES */
errores.forEach(e => addItem(listaErrores, e.tipo, `${e.fecha} ¬∑ ${e.sensor}`, "Error", "badge-red"));

/* ALERTAS */
alertas.forEach(a => {
  let c = a.nivel==="Cr√≠tica"?"badge-red":a.nivel==="Media"?"badge-yellow":"badge-green";
  addItem(listaAlertas, a.titulo, `${a.hora} h ¬∑ ${a.detalle}`, a.nivel, c);
});

/* FUGAS */
fugas.forEach(f => {
  let c=f.nivel==="Alta"?"badge-red":f.nivel==="Media"?"badge-yellow":"badge-green";
  addItem(listaFugas, f.sensor, `${f.fecha} ¬∑ Nivel ${f.nivel}`, f.estado, c);
});

/* IA */
predicciones.forEach(p => {
  const div=document.createElement("div");
  div.className="list-item";
  const score=Math.round(p.prob*100);
  div.innerHTML=`
    <div>
      <div class="list-title">${p.sensor}</div>
      <div class="ai-desc">Fuga posible en ${p.plazo}</div>
      <div class="ai-desc">${p.motivo}</div>
    </div>
    <div style="text-align:right;">
      <div class="ai-risk ${score>=80?"ai-risk-high":"ai-risk-mid"}">${score}%</div>
      <span class="badge">Riesgo</span>
    </div>`;
  listaPredicciones.appendChild(div);
});

/* GRAFICA */
new Chart(document.getElementById("consumoChart"), {
  type:"line",
  data:{ labels:consumoSemanal.dias, datasets:[{
    data:consumoSemanal.valores,
    borderColor:"#2563eb",
    backgroundColor:"rgba(37,99,235,0.16)",
    tension:0.35,
    fill:true,
    pointRadius:3
  }]},
  options:{ plugins:{legend:{display:false}},
    scales:{
      x:{ticks:{color:"#6b7280"}, grid:{color:"rgba(0,0,0,0.05)"}},
      y:{ticks:{color:"#6b7280"}, grid:{color:"rgba(0,0,0,0.05)"}}
    }
  }
});

/* TABS */
document.querySelectorAll(".tab-btn").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("tab-btn-active"));
    btn.classList.add("tab-btn-active");

    const tab=btn.getAttribute("data-tab");
    document.querySelectorAll(".tab-panel").forEach(p=>p.classList.remove("active"));
    document.getElementById("tab-"+tab).classList.add("active");
  };
});
</script>

</body>
</html>
